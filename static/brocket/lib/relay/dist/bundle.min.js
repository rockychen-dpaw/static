!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(15);t.exports=r},function(t,e){function n(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=n},function(t,e){function n(t){return"number"==typeof t&&t>-1&&t%1==0&&r>=t}var r=9007199254740991;t.exports=n},function(t,e,n){var r=n(9),o=n(2),i=n(5),s="[object Array]",c=Object.prototype,u=c.toString,a=r(Array,"isArray"),l=a||function(t){return i(t)&&o(t.length)&&u.call(t)==s};t.exports=l},function(t,e){function n(t,e){return t="number"==typeof t||r.test(t)?+t:-1,e=null==e?o:e,t>-1&&t%1==0&&e>t}var r=/^\d+$/,o=9007199254740991;t.exports=n},function(t,e){function n(t){return!!t&&"object"==typeof t}t.exports=n},function(t,e,n){function r(t){return null!=t&&i(o(t))}var o=n(31),i=n(2);t.exports=r},function(t,e,n){function r(t){return i(t)&&o(t)&&c.call(t,"callee")&&!u.call(t,"callee")}var o=n(6),i=n(5),s=Object.prototype,c=s.hasOwnProperty,u=s.propertyIsEnumerable;t.exports=r},function(t,e){function n(t,e){if("function"!=typeof t)throw new TypeError(r);return e=o(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,i=o(n.length-e,0),s=Array(i);++r<i;)s[r]=n[e+r];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,n[0],s);case 2:return t.call(this,n[0],n[1],s)}var c=Array(e+1);for(r=-1;++r<e;)c[r]=n[r];return c[e]=s,t.apply(this,c)}}var r="Expected a function",o=Math.max;t.exports=n},function(t,e,n){function r(t,e){var n=null==t?void 0:t[e];return o(n)?n:void 0}var o=n(37);t.exports=r},function(t,e,n){function r(t){return o(t)?t:Object(t)}var o=n(1);t.exports=r},function(t,e,n){function r(t){return"string"==typeof t||o(t)&&c.call(t)==i}var o=n(5),i="[object String]",s=Object.prototype,c=s.toString;t.exports=r},function(t,e,n){var r=n(38),o=n(20),i=n(30),s=i(r,o);t.exports=s},function(t,e,n){function r(t,e){if(null==t)return!1;var n=d.call(t,e);if(!n&&!a(e)){if(e=p(e),t=1==e.length?t:o(t,i(e,0,-1)),null==t)return!1;e=f(e),n=d.call(t,e)}return n||l(t.length)&&u(e,t.length)&&(c(t)||s(t))}var o=n(24),i=n(26),s=n(7),c=n(3),u=n(4),a=n(33),l=n(2),f=n(19),p=n(35),v=Object.prototype,d=v.hasOwnProperty;t.exports=r},function(t,e,n){var r=n(9),o=n(6),i=n(1),s=n(34),c=r(Object,"keys"),u=c?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&o(t)?s(t):i(t)?c(t):[]}:s;t.exports=u},function(t,e,n){/**
	 * @fileOverview
	 * @name relay.js
	 * @author Gavin Coombes
	 * @license MIT
	 * @version 0.2.0
	 * @module relay
	 *
	 * A brocket relay using the EventEmitter interface
	 *
	 */
"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function i(t,e){var n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];e.ack&&t.has(e.ack)&&(p(t.get(e.ack),e),n&&t["delete"](e.ack))}function s(t,e,n){return L.has(t,e)||(t[e]=[]),t[e]=[].concat(r(t[e]),[n]),t}function c(t,e){var n=arguments.length<=2||void 0===arguments[2]?l:arguments[2];if(e.syn){var o=e.cuid,i=t.get(o)||[],s=[].concat(r(i),[n]);t.set(o,s)}return t}function u(t,e){t&&0===t.readyState?window.setTimeout(u.bind(null,t,e),e):t&&1===t.readyState?t.close():A("Socket does not exist or is closed.")}function a(t,e,n){if(!(t.sendMode<1)){var r=(g(t.opts.wrapping,t.tag,e),f(n,e));c(t.ackRegistry,r);var o=v(r);t._send(o),t.emit("dispatch",r)}}function l(t){console.log("Ack: ",t)}function f(t,e){return t?S({syn:!0},e):e}function p(t,e){t&&t.length&&t.forEach(function(t){return t(e)})}function v(t){return JSON.stringify(t)}function d(t){var e=void 0;if(L.isString(t))e=JSON.parse(t);else{if(!L.isObject(t))throw new Error("I don't even know what he is!? "+t);e=t}return e}function h(t,e){var n=t+"/pubsub/"+e,r=t+"/pubsub/"+e;return[n,r]}function g(t,e,n){return t?b(e,n):n}function b(t,e){var n={tag:t,payload:e,time:L.now(),cuid:_()};return n}function m(t,e){return t&&(e=y(e)),e}function y(t){var e=t.payload;return o(t,["payload"]),e}var S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},x=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(u){o=!0,i=u}finally{try{!r&&c["return"]&&c["return"]()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=n(18),w=n(41),_=n(17),O=n(16),L=(E.EventEmitter,O),A=O.log;window.cuid=_;var k="|",W={debug:!1,automaticOpen:!1,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,binaryType:"blob"},j={baseAddr:void 0,channel:"",appID:void 0,userID:void 0,connID:void 0,pulse:3e4,recvMode:1,sendMode:1,conchMode:1,ignoreEcho:!1,wrapping:!0,webSocketOptions:W},I=function(){var t=Object.create(new E.EventEmitter);return t.$type="RelayModule",t}(),C=Object.create(I);C.init=function(t){var e=this;e.opts=L.defaults({},t,j),e.recvMode=L.prop(e.opts.recvMode),e.sendMode=L.prop(e.opts.sendMode),e.conchMode=L.prop(e.opts.conchMode),e._channel=L.prop(e.opts.channel);var n=h(e.opts.baseAddr,e._channel()),r=x(n,2);e.pubAddr=r[0],e.subAddr=r[1],e.message$=null,e.opts.connID=L._s6(),e.tag=[e.opts.appID,e.opts.userID,e.opts.connID].join(k),e.subscriptions=Object.create({}),e.ackRegistry=new Map,e.opts.automaticOpen&&e.connect()},C.broadcast=function(t){var e=this,n=e.subscriptions,r=t.tag,o=t.payload;p(n.global,t),p(n[r],o),e.emit("broadcast",t)},C.channel=function(t){var e=this;if(arguments.length){e._channel(t);var n=h(e.opts.baseAddr,e._channel()),r=x(n,2);e.pubAddr=r[0],e.subAddr=r[1],e.reconnect()}return e._channel()},C.connect=function(){var t=this;t._connect(w,t.opts.webSocketOptions)},C._connect=function(t,e){var n=this,r=new t(n.pubAddr,null,e);r.addEventListener("open",function(t){return n.emit("pub/open")}),r.addEventListener("close",function(){return n.emit("pub/close")}),r.addEventListener("error",function(t){return n.emit("pub/error",t)}),r.addEventListener("error",function(t){return n.emit("error",t)}),r.open(),n.pubWS=r,n.subWS=new t(n.subAddr,null,e),n.subWS.addEventListener("open",function(t){return n.emit("sub/open")}),n.subWS.addEventListener("open",function(t){return A("Opening "+n.subAddr)}),n.subWS.addEventListener("close",function(t){return n.emit("sub/close",t)}),n.subWS.addEventListener("error",function(t){return n.emit("sub/error",t)}),n.subWS.addEventListener("error",function(t){return n.emit("error",t)}),n.subWS.addEventListener("message",function(t){return n.receive(t)}),n.subWS.open(),n.emit("beat","Connecting")},C.dispatch=function(t){var e=this,n=void 0;if(!(e.sendMode<1)){if(e.opts.wrapping){var r=e.wrap(t);n=e.serialise(r)}else n=e.serialise(t);1===e.pubWS.readyState?(e.emit("dispatch",t),e.pubWS.send(n)):console.warn("Websocket is not open! Message dropped is ",t)}},C.boundDispatch=function(){return a.bind(null,this)},C.dispatchStream=function(t){var e=self.dispatch.bind(self);t.subscribe(e)},C.inject_kefir=function(t){var e=this,n=t.fromEvents(e,"receive");e.message$=n},C.inject_rx=function(t){var e=this,n=t.Observable.fromEvent(e,"receive"),r=new t.BehaviorSubject;n.subscribe(r),e.message$=r},C.receive=function(t){var e=this;if(!(e.recvMode<1)){var n=e.deserialise(t.data);i(e.ackRegistry,n);var r=m(e.opts.wrapping,n),s=r.tag,c=r.payload,u=o(r,["tag","payload"]),a=s.split(k),l=x(a,3),f=(l[0],l[1],l[2]);if(e.opts.ignoreEcho&&e.opts.connID===f)return void A("Echo ignored. connID: "+e.opts.connID);var p=S({tag:s,payload:c},u);e.broadcast(p),e.emit("receive",p)}},C.reconnect=function(){var t=this;t.pubWS&&t.pubWS.close(),t.subWS&&t.subWS.close(),t.connect()},C.subscribe=function(){for(var t=this,e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];var o=n[0],i=n[1];if(!i){var c=["global",o];o=c[0],i=c[1]}t.subscriptions=s(t.subscriptions,o,i)},C.destroy=function(t){var e=this;t=t||100,u(e.pubWS,t),u(e.subWS,t)},C.wrap=function(t){var e=this;return b(e.tag,t)},C.unwrap=y,C.serialise=v,C.deserialise=d,C.module={acknowledge:i,registerSyn:c,maybe_syn:f,wrap:b},t.exports=C},function(t,e,n){"use strict";function r(t){var e=function(e){return arguments.length&&(t=e),t};return e.toJSON=function(){return t},e}function o(){return Math.floor(16777216*(1+Math.random())).toString(16).substring(1)}function i(){return(new Date).toISOString()}/**
	 * @fileOverview
	 * @name utility.js<relay>
	 * @author Gavin Coombes
	 * @license BSD-3-Clause
	 *
	 * Local util script just inlines functions from dpaw-brocket-utility and lodash
	 */
var s=function(){},c=Function.prototype.bind.call(console.log,console);s.prop=r,s.isObject=n(1),s.isString=n(11),s.has=n(13),s.defaults=n(12),t.exports={prop:r,log:c,_s6:o,has:n(13),defaults:n(12),isObject:n(1),isString:n(11),now:i}},function(t,e,n){!function(e){"use strict";var n="cuid",r=0,o=4,i=36,s=Math.pow(i,o),c=function(t,e){var n="000000000"+t;return n.substr(n.length-e)},u=function(){return c((Math.random()*s<<0).toString(i),o)},a=function(){return r=s>r?r:0,r++,r-1},l=function(){var t,e="c",n=(new Date).getTime().toString(i),r=l.fingerprint(),s=u()+u();return t=c(a().toString(i),o),e+n+t+r+s};l.slug=function(){var t,e=(new Date).getTime().toString(36),n=l.fingerprint().slice(0,1)+l.fingerprint().slice(-1),r=u().slice(-2);return t=a().toString(36).slice(-4),e.slice(-2)+t+n+r},l.globalCount=function(){var t=function(){var t,e=0;for(t in window)e++;return e}();return l.globalCount=function(){return t},t},l.fingerprint=function(){return c((navigator.mimeTypes.length+navigator.userAgent.length).toString(36)+l.globalCount().toString(36),4)},e.register?e.register(n,l):t.exports=l}(this.applitude||this)},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function o(t){return"number"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,o,c,u,a;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:c=Array.prototype.slice.call(arguments,1),n.apply(this,c)}else if(i(n))for(c=Array.prototype.slice.call(arguments,1),a=n.slice(),o=a.length,u=0;o>u;u++)a[u].apply(this,c);return!0},n.prototype.addListener=function(t,e){var o;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),o||(o=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var o=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,o,s,c;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(c=s;c-- >0;)if(n[c]===e||n[c].listener&&n[c].listener===e){o=c;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){function n(t){var e=t?t.length:0;return e?t[e-1]:void 0}t.exports=n},function(t,e){function n(t,e){return void 0===t?e:t}t.exports=n},function(t,e,n){function r(t,e,n){for(var r=-1,i=o(e),s=i.length;++r<s;){var c=i[r],u=t[c],a=n(u,e[c],c,t,e);(a===a?a===u:u!==u)&&(void 0!==u||c in t)||(t[c]=a)}return t}var o=n(14);t.exports=r},function(t,e,n){function r(t,e){return null==e?t:o(e,i(e),t)}var o=n(23),i=n(14);t.exports=r},function(t,e){function n(t,e,n){n||(n={});for(var r=-1,o=e.length;++r<o;){var i=e[r];n[i]=t[i]}return n}t.exports=n},function(t,e,n){function r(t,e,n){if(null!=t){void 0!==n&&n in o(t)&&(e=[n]);for(var r=0,i=e.length;null!=t&&i>r;)t=t[e[r++]];return r&&r==i?t:void 0}}var o=n(10);t.exports=r},function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}t.exports=n},function(t,e){function n(t,e,n){var r=-1,o=t.length;e=null==e?0:+e||0,0>e&&(e=-e>o?0:o+e),n=void 0===n||n>o?o:+n||0,0>n&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}t.exports=n},function(t,e){function n(t){return null==t?"":t+""}t.exports=n},function(t,e,n){function r(t,e,n){if("function"!=typeof t)return o;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)};case 5:return function(n,r,o,i,s){return t.call(e,n,r,o,i,s)}}return function(){return t.apply(e,arguments)}}var o=n(40);t.exports=r},function(t,e,n){function r(t){return s(function(e,n){var r=-1,s=null==e?0:n.length,c=s>2?n[s-2]:void 0,u=s>2?n[2]:void 0,a=s>1?n[s-1]:void 0;for("function"==typeof c?(c=o(c,a,5),s-=2):(c="function"==typeof a?a:void 0,s-=c?1:0),u&&i(n[0],n[1],u)&&(c=3>s?void 0:c,s=1);++r<s;){var l=n[r];l&&t(e,l,c)}return e})}var o=n(28),i=n(32),s=n(8);t.exports=r},function(t,e,n){function r(t,e){return o(function(n){var r=n[0];return null==r?r:(n.push(e),t.apply(void 0,n))})}var o=n(8);t.exports=r},function(t,e,n){var r=n(25),o=r("length");t.exports=o},function(t,e,n){function r(t,e,n){if(!s(n))return!1;var r=typeof e;if("number"==r?o(n)&&i(e,n.length):"string"==r&&e in n){var c=n[e];return t===t?t===c:c!==c}return!1}var o=n(6),i=n(4),s=n(1);t.exports=r},function(t,e,n){function r(t,e){var n=typeof t;if("string"==n&&c.test(t)||"number"==n)return!0;if(o(t))return!1;var r=!s.test(t);return r||null!=e&&t in i(e)}var o=n(3),i=n(10),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,c=/^\w*$/;t.exports=r},function(t,e,n){function r(t){for(var e=u(t),n=e.length,r=n&&t.length,a=!!r&&c(r)&&(i(t)||o(t)),f=-1,p=[];++f<n;){var v=e[f];(a&&s(v,r)||l.call(t,v))&&p.push(v)}return p}var o=n(7),i=n(3),s=n(4),c=n(2),u=n(39),a=Object.prototype,l=a.hasOwnProperty;t.exports=r},function(t,e,n){function r(t){if(i(t))return t;var e=[];return o(t).replace(s,function(t,n,r,o){e.push(r?o.replace(c,"$1"):n||t)}),e}var o=n(27),i=n(3),s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,c=/\\(\\)?/g;t.exports=r},function(t,e,n){function r(t){return o(t)&&c.call(t)==i}var o=n(1),i="[object Function]",s=Object.prototype,c=s.toString;t.exports=r},function(t,e,n){function r(t){return null==t?!1:o(t)?l.test(u.call(t)):i(t)&&s.test(t)}var o=n(36),i=n(5),s=/^\[object .+?Constructor\]$/,c=Object.prototype,u=Function.prototype.toString,a=c.hasOwnProperty,l=RegExp("^"+u.call(a).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=r},function(t,e,n){var r=n(21),o=n(22),i=n(29),s=i(function(t,e,n){return n?r(t,e,n):o(t,e)});t.exports=s},function(t,e,n){function r(t){if(null==t)return[];u(t)||(t=Object(t));var e=t.length;e=e&&c(e)&&(i(t)||o(t))&&e||0;for(var n=t.constructor,r=-1,a="function"==typeof n&&n.prototype===t,f=Array(e),p=e>0;++r<e;)f[r]=r+"";for(var v in t)p&&s(v,e)||"constructor"==v&&(a||!l.call(t,v))||f.push(v);return f}var o=n(7),i=n(3),s=n(4),c=n(2),u=n(1),a=Object.prototype,l=a.hasOwnProperty;t.exports=r},function(t,e){function n(t){return t}t.exports=n},function(t,e,n){var r,o,i;!function(n,s){o=[],r=s,i="function"==typeof r?r.apply(e,o):r,!(void 0!==i&&(t.exports=i))}(this,function(){function t(e,n,r){function o(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}var i={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null};r||(r={});for(var s in i)"undefined"!=typeof r[s]?this[s]=r[s]:this[s]=i[s];this.url=e,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var c,u=this,a=!1,l=!1,f=document.createElement("div");f.addEventListener("open",function(t){u.onopen(t)}),f.addEventListener("close",function(t){u.onclose(t)}),f.addEventListener("connecting",function(t){u.onconnecting(t)}),f.addEventListener("message",function(t){u.onmessage(t)}),f.addEventListener("error",function(t){u.onerror(t)}),this.addEventListener=f.addEventListener.bind(f),this.removeEventListener=f.removeEventListener.bind(f),this.dispatchEvent=f.dispatchEvent.bind(f),this.open=function(e){if(c=new WebSocket(u.url,n||[]),e){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else f.dispatchEvent(o("connecting")),this.reconnectAttempts=0;(u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",u.url);var r=c,i=setTimeout(function(){(u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",u.url),l=!0,r.close(),l=!1},u.timeoutInterval);c.onopen=function(n){clearTimeout(i),(u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","onopen",u.url),u.protocol=c.protocol,u.readyState=WebSocket.OPEN,u.reconnectAttempts=0;var r=o("open");r.isReconnect=e,e=!1,f.dispatchEvent(r)},c.onclose=function(n){if(clearTimeout(i),c=null,a)u.readyState=WebSocket.CLOSED,f.dispatchEvent(o("close"));else{u.readyState=WebSocket.CONNECTING;var r=o("connecting");r.code=n.code,r.reason=n.reason,r.wasClean=n.wasClean,f.dispatchEvent(r),e||l||((u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","onclose",u.url),f.dispatchEvent(o("close")));var i=u.reconnectInterval*Math.pow(u.reconnectDecay,u.reconnectAttempts);setTimeout(function(){u.reconnectAttempts++,u.open(!0)},i>u.maxReconnectInterval?u.maxReconnectInterval:i)}},c.onmessage=function(e){(u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",u.url,e.data);var n=o("message");n.data=e.data,f.dispatchEvent(n)},c.onerror=function(e){(u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","onerror",u.url,e),f.dispatchEvent(o("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(e){if(c)return(u.debug||t.debugAll)&&console.debug("ReconnectingWebSocket","send",u.url,e),c.send(e);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(t,e){"undefined"==typeof t&&(t=1e3),a=!0,c&&c.close(t,e)},this.refresh=function(){c&&c.close()}}return"WebSocket"in window?(t.prototype.onopen=function(t){},t.prototype.onclose=function(t){},t.prototype.onconnecting=function(t){},t.prototype.onmessage=function(t){},t.prototype.onerror=function(t){},t.debugAll=!1,t.CONNECTING=WebSocket.CONNECTING,t.OPEN=WebSocket.OPEN,t.CLOSING=WebSocket.CLOSING,t.CLOSED=WebSocket.CLOSED,t):void 0})}]);